**Note:** This document makes extensive use of Unicode symbols for mathematical
notation. Please make sure that your used font supports all these symbols. If
not, use a different font (like DejaVu Sans Mono).

The proofs use the notation from the paper, so you should read the paper before
attempting to understand the proofs.


**Proof of Lemma 3:**
We have ŒΩ(P) = |L(P)| - max_(K‚äÜL(P)) (|K| - |N(K)|) for bipartite matching
problems with neighbors N(K) of K [LP86]. Let K be a set of leaves such that
|K| - |N(K)| is maximum and X is the set of shapes of the leaves in K. As a
leaf can be matched to all variables of at most the same shape, N(K) = V(‚ÜìX).
If there is a leaf x ‚àâ K of a shape in ‚ÜìX, |K ‚à™ {x}| - |V(‚ÜìX)| > |K| - |V(‚ÜìX)|,
contradicting our choice of K. Hence, K = L(P, ‚ÜìX). ‚àé


**Proof of Lemma 4:**
We prove the contrapositive. Suppose ŒΩ(T) < ŒΩ(P). By Lemma 3, there is a set X
with |L(P, ‚ÜìX)| - |V(‚ÜìX)| < |L(T, ‚ÜìX)| - |V(‚ÜìX)|. Choose X such that X = ‚ÜìX.
Then |L(P, X)| < |L(T, X)|. Since |L(P)| = |L(T)|, |\L(P, XÃÖ)| > |L(T, XÃÖ)|$. As
X = ‚ÜìX, XÃÖ = ‚ÜëXÃÖ$. Thus, |{ y ‚àà L(P) | y ‚àà ‚ÜëXÃÖ }| > |{ y ‚àà L(T) | y ‚àà ‚ÜëXÃÖ }|, which
implies |Œ¥(P, T, ‚ÜëXÃÖ)| > |Œ¥(T, P, ‚ÜëXÃÖ)|. ‚àé


**Proof of Lemma 5:**
Let the bipartite graph (A, B, E) have partitions A = L(R + Œ≥‚ÇÅ) \ L(R + Œ≥‚ÇÇ) and
B = L(R + Œ≥‚ÇÇ) \ L(R + Œ≥‚ÇÅ) and edges E between a ‚àà A and b ‚àà B if a ‚â§ b. As
|Œ¥(R + Œ≥‚ÇÅ, R + Œ≥‚ÇÇ, ‚ÜëX)| ‚â§ |Œ¥(R + Œ≥‚ÇÇ, R + Œ≥‚ÇÅ, ‚ÜëX)| also holds for arbitrary
subsets of L(R + Œ≥‚ÇÅ), by Hall's Marriage Theorem (A, B, E) has a matching of
all a ‚àà A. Since Œ≥‚ÇÅ and Œ≥‚ÇÇ comprise the same operations, the subtrees connected
to arg-edges of R + Œ≥‚ÇÅ may instead be connected to the matched leaf arg-edges
of R + Œ≥‚ÇÇ. Since a matched leaf from B has at least the same shape as its
counterpart in A, the resulting program P π satisfies ŒΩ(P π) ‚â• \ŒΩ(P) by Lemma 4. ‚àé


**Proof of Lemma 6:**
Let s be the shape of the leaf l of S‚ÇÅ. As PS_P(a·µ¢) = ùÑç, all leaf shapes of S‚ÇÅ
(excluding s) are still present in T1(P, a). For each remaining leaf shape t,
T1(P, a) has a leaf shape s ‚äî t ‚â• t. By Lemma 4, ŒΩ(T1(P, a·µ¢)) ‚â• ŒΩ(P). ‚àé


**Proof of Lemma 7:**
Compared with P, T2(P, a‚ÇÅ, a‚±º) contains all but one leaf shapes from S‚ÇÅ because
PS_P(a‚ÇÅ) = PS_P(a‚±º). Since all arg-edges of S‚ÇÅ have a shape of at least
PS_P(a‚ÇÅ), each leaf of S‚ÇÇ (including a leaf for a‚±º) is at least as large in
T2(P, a‚ÇÅ, a‚±º) as in P. Thus, by Lemma 4, ŒΩ(T2(P, a‚ÇÅ, a‚±º)) ‚â• ŒΩ(P). ‚àé


**Proof of Lemma 8:**
Let T = T3(P, a‚ÇÅ, a‚ÇÇ, a‚ÇÉ). Because of premise (b), PS_P(a‚ÇÇ) = PS_T(a‚ÇÇ) and
PS_P(a‚ÇÉ) = PS_T(a‚ÇÉ); see Fig. 10.

Since PS_P(a‚ÇÅ) = PS_T(a‚ÇÇ) by premise (c), S‚ÇÅ contributes the same leaf shapes
in P and T. Moreover, since PS_P(a‚ÇÉ) = PS_T(a‚ÇÅ) by premises (a) and (c), S‚ÇÉ
also contributes the same leaf shapes in P and T. Since PS_P(a‚ÇÇ) ‚â§ PS_T(a‚ÇÉ) by
premise (a), each leaf contributed by S‚ÇÇ is at least as large in T as it is in
P. Thus, by Lemma 4, ŒΩ(T) ‚â• ŒΩ(P). ‚àé


**References**

[LP86] Lov√°sz, L√°szl√≥ and Plummer, Michael D.: Matching Theory. Elsevier,
       Amsterdam, The Netherlands (1986).
